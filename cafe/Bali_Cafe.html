<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<script>
    // ใช้ Config เดียวกับหน้าแรกของคุณ
    const firebaseConfig = {
        apiKey: "AIzaSyDt4kR8SacD2LPwmyFpcZ4FNHJpCT-pOwc",
        authDomain: "phichit-cafe.firebaseapp.com",
        projectId: "phichit-cafe",
        storageBucket: "phichit-cafe.appspot.com",
        messagingSenderId: "825175930096",
        appId: "1:825175930096:web:32336ea0ebc1cdf3c33e35"
    };

    if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
    }

    const db = firebase.firestore();
    
    // กำหนด ID ของร้านนี้ (ต้องตรงกับในหน้าแรก)
    const cafeId = "1425_Cafe.html"; 
    const checkinBtn = document.getElementById('checkin-btn');
    const statusMsg = document.getElementById('status-msg');

    checkinBtn.addEventListener('click', () => {
        checkinBtn.innerText = "กำลังบันทึก...";
        checkinBtn.disabled = true;

        // บันทึกลงคอลเลกชัน visited_cafes
        db.collection("visited_cafes").doc(cafeId).set({
            visited: true,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        })
        .then(() => {
            checkinBtn.innerText = "เช็คอินแล้ว!";
            checkinBtn.style.backgroundColor = "#28a745";
            statusMsg.innerText = "บันทึกข้อมูลเรียบร้อย! หน้าแรกจะเปลี่ยนเป็นสีเขียวแล้วค่ะ";
        })
        .catch((error) => {
            console.error("Error:", error);
            checkinBtn.disabled = false;
            checkinBtn.innerText = "ลองใหม่อีกครั้ง";
        });
    });
</script>